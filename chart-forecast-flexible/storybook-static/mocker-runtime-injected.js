var j=class{registryByUrl=new Map;registryById=new Map;clear(){this.registryByUrl.clear(),this.registryById.clear()}keys(){return this.registryByUrl.keys()}add(e){this.registryByUrl.set(e.url,e),this.registryById.set(e.id,e)}register(e,r,t,n,i){let a=typeof e=="object"?e.type:e;if(typeof e=="object"){let o=e;if(o instanceof B||o instanceof X||o instanceof Y||o instanceof q)throw new TypeError(`[vitest] Cannot register a mock that is already defined. Expected a JSON representation from \`MockedModule.toJSON\`, instead got "${o.type}". Use "registry.add()" to update a mock instead.`);if(o.type==="automock"){let s=B.fromJSON(o);return this.add(s),s}else if(o.type==="autospy"){let s=X.fromJSON(o);return this.add(s),s}else if(o.type==="redirect"){let s=q.fromJSON(o);return this.add(s),s}else throw o.type==="manual"?new Error("Cannot set serialized manual mock. Define a factory function manually with `ManualMockedModule.fromJSON()`."):new Error(`Unknown mock type: ${o.type}`)}if(typeof r!="string")throw new TypeError("[vitest] Mocks require a raw string.");if(typeof n!="string")throw new TypeError("[vitest] Mocks require a url string.");if(typeof t!="string")throw new TypeError("[vitest] Mocks require an id string.");if(a==="manual"){if(typeof i!="function")throw new TypeError("[vitest] Manual mocks require a factory function.");let o=new Y(r,t,n,i);return this.add(o),o}else if(a==="automock"||a==="autospy"){let o=a==="automock"?new B(r,t,n):new X(r,t,n);return this.add(o),o}else if(a==="redirect"){if(typeof i!="string")throw new TypeError("[vitest] Redirect mocks require a redirect string.");let o=new q(r,t,n,i);return this.add(o),o}else throw new Error(`[vitest] Unknown mock type: ${a}`)}delete(e){this.registryByUrl.delete(e)}get(e){return this.registryByUrl.get(e)}getById(e){return this.registryById.get(e)}has(e){return this.registryByUrl.has(e)}},B=class{type="automock";constructor(e,r,t){this.raw=e,this.id=r,this.url=t}static fromJSON(e){return new X(e.raw,e.id,e.url)}toJSON(){return{type:this.type,url:this.url,raw:this.raw,id:this.id}}},X=class ge{type="autospy";constructor(r,t,n){this.raw=r,this.id=t,this.url=n}static fromJSON(r){return new ge(r.raw,r.id,r.url)}toJSON(){return{type:this.type,url:this.url,id:this.id,raw:this.raw}}},q=class ke{type="redirect";constructor(r,t,n,i){this.raw=r,this.id=t,this.url=n,this.redirect=i}static fromJSON(r){return new ke(r.raw,r.id,r.url,r.redirect)}toJSON(){return{type:this.type,url:this.url,raw:this.raw,id:this.id,redirect:this.redirect}}},Y=class we{cache;type="manual";constructor(r,t,n,i){this.raw=r,this.id=t,this.url=n,this.factory=i}async resolve(){if(this.cache)return this.cache;let r;try{r=await this.factory()}catch(t){let n=new Error('[vitest] There was an error when mocking a module. If you are using "vi.mock" factory, make sure there are no top level variables inside, since this call is hoisted to top of the file. Read more: https://vitest.dev/api/vi.html#vi-mock');throw n.cause=t,n}if(r===null||typeof r!="object"||Array.isArray(r))throw new TypeError(`[vitest] vi.mock("${this.raw}", factory?: () => unknown) is not returning an object. Did you mean to return an object with a "default" key?`);return this.cache=r}static fromJSON(r,t){return new we(r.raw,r.id,r.url,t)}toJSON(){return{type:this.type,url:this.url,id:this.id,raw:this.raw}}};function ve(e,r,t={}){let n=new Array,i=new Se,a=(u,f,y)=>{try{return u[f]=y,!0}catch{return!1}},o=(u,f)=>{let y=F(u),g=y==="Module"||!!u.__esModule;for(let{key:m,descriptor:b}of K(u,g,e.globalConstructors)){if(!g&&b.get){try{Object.defineProperty(f,m,b)}catch{}continue}if(Ee(m,y))continue;let k=u[m],l=i.getId(k);if(l!==void 0){n.push(()=>a(f,m,i.getMockedValue(l)));continue}let c=F(k);if(Array.isArray(k)){a(f,m,[]);continue}let x=c.includes("Function")&&typeof k=="function";if((!x||k._isMockFunction)&&c!=="Object"&&c!=="Module"){a(f,m,k);continue}if(a(f,m,x?k:{})){if(x){let R=function(){if(this instanceof f[m])for(let{key:I,descriptor:$}of K(this,!1,e.globalConstructors)){if($.get)continue;let O=this[I];if(F(O).includes("Function")&&typeof O=="function"){let p=this[I],h=E(this,I).mockImplementation(p),J=h.mockReset;h.mockRestore=h.mockReset=()=>(J.call(h),h.mockImplementation(p),h)}}};if(!e.spyOn)throw new Error("[@vitest/mocker] `spyOn` is not defined. This is a Vitest error. Please open a new issue with reproduction.");let E=e.spyOn,M=E(f,m);if(e.type==="automock"){M.mockImplementation(R);let I=M.mockReset;M.mockRestore=M.mockReset=()=>(I.call(M),M.mockImplementation(R),M)}Object.defineProperty(f[m],"length",{value:0})}i.track(k,f[m]),o(k,f[m])}}},s=t;o(r,s);for(let u of n)u();return s}var Se=class{idMap=new Map;mockedValueMap=new Map;getId(e){return this.idMap.get(e)}getMockedValue(e){return this.mockedValueMap.get(e)}track(e,r){let t=this.idMap.size;return this.idMap.set(e,t),this.mockedValueMap.set(t,r),t}};function F(e){return Object.prototype.toString.apply(e).slice(8,-1)}function Ee(e,r){return r.includes("Function")&&typeof e=="string"&&["arguments","callee","caller","length","name"].includes(e)}function K(e,r,t){let{Map:n,Object:i,Function:a,RegExp:o,Array:s}=t,u=new n,f=e;do{if(f===i.prototype||f===a.prototype||f===o.prototype)break;_e(f,y=>{let g=i.getOwnPropertyDescriptor(f,y);g&&u.set(y,{key:y,descriptor:g})})}while(f=i.getPrototypeOf(f));if(r&&!u.has("default")&&"default"in e){let y=i.getOwnPropertyDescriptor(e,"default");y&&u.set("default",{key:"default",descriptor:y})}return s.from(u.values())}function _e(e,r){let t=typeof r=="function"?r:n=>r.add(n);Object.getOwnPropertyNames(e).forEach(t),Object.getOwnPropertySymbols(e).forEach(t)}var be=/^[A-Za-z]:\//;function H(e=""){return e&&e.replace(/\\/g,"/").replace(be,r=>r.toUpperCase())}var Ie=/^[/\\]{2}/,xe=/^[/\\](?![/\\])|^[/\\]{2}(?!\.)|^[A-Za-z]:[/\\]/,Te=/^[A-Za-z]:$/,Me=/.(\.[^./]+|\.)$/,Pe=function(e){if(e.length===0)return".";e=H(e);let r=e.match(Ie),t=Z(e),n=e[e.length-1]==="/";return e=$e(e,!t),e.length===0?t?"/":n?"./":".":(n&&(e+="/"),Te.test(e)&&(e+="/"),r?t?`//${e}`:`//./${e}`:t&&!Z(e)?`/${e}`:e)},Re=function(...e){let r="";for(let t of e)if(t)if(r.length>0){let n=r[r.length-1]==="/",i=t[0]==="/";n&&i?r+=t.slice(1):r+=n||i?t:`/${t}`}else r+=t;return Pe(r)};function $e(e,r){let t="",n=0,i=-1,a=0,o=null;for(let s=0;s<=e.length;++s){if(s<e.length)o=e[s];else{if(o==="/")break;o="/"}if(o==="/"){if(!(i===s-1||a===1))if(a===2){if(t.length<2||n!==2||t[t.length-1]!=="."||t[t.length-2]!=="."){if(t.length>2){let u=t.lastIndexOf("/");u===-1?(t="",n=0):(t=t.slice(0,u),n=t.length-1-t.lastIndexOf("/")),i=s,a=0;continue}else if(t.length>0){t="",n=0,i=s,a=0;continue}}r&&(t+=t.length>0?"/..":"..",n=2)}else t.length>0?t+=`/${e.slice(i+1,s)}`:t=e.slice(i+1,s),n=s-i-1;i=s,a=0}else o==="."&&a!==-1?++a:a=-1}return t}var Z=function(e){return xe.test(e)},Ae=function(e){if(e==="..")return"";let r=Me.exec(H(e));return r&&r[1]||""},Oe={reset:[0,0],bold:[1,22,"\x1B[22m\x1B[1m"],dim:[2,22,"\x1B[22m\x1B[2m"],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]},Ce=Object.entries(Oe);function U(e){return String(e)}U.open="",U.close="";function Ne(e=!1){let r=typeof process<"u"?process:void 0,t=r?.env||{},n=r?.argv||[];return!("NO_COLOR"in t||n.includes("--no-color"))&&("FORCE_COLOR"in t||n.includes("--color")||r?.platform==="win32"||e&&t.TERM!=="dumb"||"CI"in t)||typeof window<"u"&&!!window.chrome}function Le(e=!1){let r=Ne(e),t=(o,s,u,f)=>{let y="",g=0;do y+=o.substring(g,f)+u,g=f+s.length,f=o.indexOf(s,g);while(~f);return y+o.substring(g)},n=(o,s,u=o)=>{let f=y=>{let g=String(y),m=g.indexOf(s,o.length);return~m?o+t(g,s,u,m)+s:o+g+s};return f.open=o,f.close=s,f},i={isColorSupported:r},a=o=>`\x1B[${o}m`;for(let[o,s]of Ce)i[o]=r?n(a(s[0]),a(s[1]),s[2]):U;return i}Le();function G(e,r){return r.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(n){if(n!=="default"&&!(n in e)){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}})}),Object.freeze(e)}function Q(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ee={exports:{}},v={},te;function Je(){if(te)return v;te=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.for("react.view_transition"),b=Symbol.for("react.client.reference");function k(l){if(typeof l=="object"&&l!==null){var c=l.$$typeof;switch(c){case e:switch(l=l.type,l){case t:case i:case n:case u:case f:case m:return l;default:switch(l=l&&l.$$typeof,l){case o:case s:case g:case y:return l;case a:return l;default:return c}}case r:return c}}}return v.ContextConsumer=a,v.ContextProvider=o,v.Element=e,v.ForwardRef=s,v.Fragment=t,v.Lazy=g,v.Memo=y,v.Portal=r,v.Profiler=i,v.StrictMode=n,v.Suspense=u,v.SuspenseList=f,v.isContextConsumer=function(l){return k(l)===a},v.isContextProvider=function(l){return k(l)===o},v.isElement=function(l){return typeof l=="object"&&l!==null&&l.$$typeof===e},v.isForwardRef=function(l){return k(l)===s},v.isFragment=function(l){return k(l)===t},v.isLazy=function(l){return k(l)===g},v.isMemo=function(l){return k(l)===y},v.isPortal=function(l){return k(l)===r},v.isProfiler=function(l){return k(l)===i},v.isStrictMode=function(l){return k(l)===n},v.isSuspense=function(l){return k(l)===u},v.isSuspenseList=function(l){return k(l)===f},v.isValidElementType=function(l){return typeof l=="string"||typeof l=="function"||l===t||l===i||l===n||l===u||l===f||typeof l=="object"&&l!==null&&(l.$$typeof===g||l.$$typeof===y||l.$$typeof===o||l.$$typeof===a||l.$$typeof===s||l.$$typeof===b||l.getModuleId!==void 0)},v.typeOf=k,v}var re;function Be(){return re||(re=1,ee.exports=Je()),ee.exports}var ne=Be(),Xe=Q(ne),qe=G({__proto__:null,default:Xe},[ne]),ie={exports:{}},w={},oe;function Fe(){if(oe)return w;oe=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),s=Symbol.for("react.server_context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),k;k=Symbol.for("react.module.reference");function l(c){if(typeof c=="object"&&c!==null){var x=c.$$typeof;switch(x){case e:switch(c=c.type,c){case t:case i:case n:case f:case y:return c;default:switch(c=c&&c.$$typeof,c){case s:case o:case u:case m:case g:case a:return c;default:return x}}case r:return x}}}return w.ContextConsumer=o,w.ContextProvider=a,w.Element=e,w.ForwardRef=u,w.Fragment=t,w.Lazy=m,w.Memo=g,w.Portal=r,w.Profiler=i,w.StrictMode=n,w.Suspense=f,w.SuspenseList=y,w.isAsyncMode=function(){return!1},w.isConcurrentMode=function(){return!1},w.isContextConsumer=function(c){return l(c)===o},w.isContextProvider=function(c){return l(c)===a},w.isElement=function(c){return typeof c=="object"&&c!==null&&c.$$typeof===e},w.isForwardRef=function(c){return l(c)===u},w.isFragment=function(c){return l(c)===t},w.isLazy=function(c){return l(c)===m},w.isMemo=function(c){return l(c)===g},w.isPortal=function(c){return l(c)===r},w.isProfiler=function(c){return l(c)===i},w.isStrictMode=function(c){return l(c)===n},w.isSuspense=function(c){return l(c)===f},w.isSuspenseList=function(c){return l(c)===y},w.isValidElementType=function(c){return typeof c=="string"||typeof c=="function"||c===t||c===i||c===n||c===f||c===y||c===b||typeof c=="object"&&c!==null&&(c.$$typeof===m||c.$$typeof===g||c.$$typeof===a||c.$$typeof===o||c.$$typeof===u||c.$$typeof===k||c.getModuleId!==void 0)},w.typeOf=l,w}var se;function Ue(){return se||(se=1,ie.exports=Fe()),ie.exports}var ae=Ue(),De=Q(ae),ze=G({__proto__:null,default:De},[ae]),Ve=["isAsyncMode","isConcurrentMode","isContextConsumer","isContextProvider","isElement","isForwardRef","isFragment","isLazy","isMemo","isPortal","isProfiler","isStrictMode","isSuspense","isSuspenseList","isValidElementType"];Object.fromEntries(Ve.map(e=>[e,r=>ze[e](r)||qe[e](r)]));var We=()=>"Promise{\u2026}";try{let{getPromiseDetails:e,kPending:r,kRejected:t}=process.binding("util");Array.isArray(e(Promise.resolve()))&&(We=(n,i)=>{let[a,o]=e(n);return a===r?"Promise{<pending>}":`Promise${a===t?"!":""}{${i.inspect(o,i)}}`})}catch{}function je(e){let{message:r="$$stack trace error",stackTraceLimit:t=1}=e||{},n=Error.stackTraceLimit,i=Error.prepareStackTrace;Error.stackTraceLimit=t,Error.prepareStackTrace=o=>o.stack;let a=new Error(r).stack||"";return Error.prepareStackTrace=i,Error.stackTraceLimit=n,a}var D,le;function Ye(){if(le)return D;le=1;var e,r,t,n,i,a,o,s,u,f,y,g,m,b,k,l,c,x,R;return m=/\/(?![*\/])(?:\[(?:(?![\]\\]).|\\.)*\]|(?![\/\\]).|\\.)*(\/[$_\u200C\u200D\p{ID_Continue}]*|\\)?/uy,g=/--|\+\+|=>|\.{3}|\??\.(?!\d)|(?:&&|\|\||\?\?|[+\-%&|^]|\*{1,2}|<{1,2}|>{1,3}|!=?|={1,2}|\/(?![\/*]))=?|[?~,:;[\](){}]/y,e=/(\x23?)(?=[$_\p{ID_Start}\\])(?:[$_\u200C\u200D\p{ID_Continue}]|\\u[\da-fA-F]{4}|\\u\{[\da-fA-F]+\})+/uy,k=/(['"])(?:(?!\1)[^\\\n\r]|\\(?:\r\n|[^]))*(\1)?/y,y=/(?:0[xX][\da-fA-F](?:_?[\da-fA-F])*|0[oO][0-7](?:_?[0-7])*|0[bB][01](?:_?[01])*)n?|0n|[1-9](?:_?\d)*n|(?:(?:0(?!\d)|0\d*[89]\d*|[1-9](?:_?\d)*)(?:\.(?:\d(?:_?\d)*)?)?|\.\d(?:_?\d)*)(?:[eE][+-]?\d(?:_?\d)*)?|0[0-7]+/y,l=/[`}](?:[^`\\$]|\\[^]|\$(?!\{))*(`|\$\{)?/y,R=/[\t\v\f\ufeff\p{Zs}]+/uy,s=/\r?\n|[\r\u2028\u2029]/y,u=/\/\*(?:[^*]|\*(?!\/))*(\*\/)?/y,b=/\/\/.*/y,t=/[<>.:={}]|\/(?![\/*])/y,r=/[$_\p{ID_Start}][$_\u200C\u200D\p{ID_Continue}-]*/uy,n=/(['"])(?:(?!\1)[^])*(\1)?/y,i=/[^<>{}]+/y,x=/^(?:[\/+-]|\.{3}|\?(?:InterpolationIn(?:JSX|Template)|NoLineTerminatorHere|NonExpressionParenEnd|UnaryIncDec))?$|[{}([,;<>=*%&|^!~?:]$/,c=/^(?:=>|[;\]){}]|else|\?(?:NoLineTerminatorHere|NonExpressionParenEnd))?$/,a=/^(?:await|case|default|delete|do|else|instanceof|new|return|throw|typeof|void|yield)$/,o=/^(?:return|throw|yield)$/,f=RegExp(s.source),D=function*(E,{jsx:M=!1}={}){var I,$,O,p,h,J,d,P,W,T,C,S,N,_;for({length:J}=E,p=0,h="",_=[{tag:"JS"}],I=[],C=0,S=!1;p<J;){switch(P=_[_.length-1],P.tag){case"JS":case"JSNonExpressionParen":case"InterpolationInTemplate":case"InterpolationInJSX":if(E[p]==="/"&&(x.test(h)||a.test(h))&&(m.lastIndex=p,d=m.exec(E))){p=m.lastIndex,h=d[0],S=!0,yield{type:"RegularExpressionLiteral",value:d[0],closed:d[1]!==void 0&&d[1]!=="\\"};continue}if(g.lastIndex=p,d=g.exec(E)){switch(N=d[0],W=g.lastIndex,T=N,N){case"(":h==="?NonExpressionParenKeyword"&&_.push({tag:"JSNonExpressionParen",nesting:C}),C++,S=!1;break;case")":C--,S=!0,P.tag==="JSNonExpressionParen"&&C===P.nesting&&(_.pop(),T="?NonExpressionParenEnd",S=!1);break;case"{":g.lastIndex=0,O=!c.test(h)&&(x.test(h)||a.test(h)),I.push(O),S=!1;break;case"}":switch(P.tag){case"InterpolationInTemplate":if(I.length===P.nesting){l.lastIndex=p,d=l.exec(E),p=l.lastIndex,h=d[0],d[1]==="${"?(h="?InterpolationInTemplate",S=!1,yield{type:"TemplateMiddle",value:d[0]}):(_.pop(),S=!0,yield{type:"TemplateTail",value:d[0],closed:d[1]==="`"});continue}break;case"InterpolationInJSX":if(I.length===P.nesting){_.pop(),p+=1,h="}",yield{type:"JSXPunctuator",value:"}"};continue}}S=I.pop(),T=S?"?ExpressionBraceEnd":"}";break;case"]":S=!0;break;case"++":case"--":T=S?"?PostfixIncDec":"?UnaryIncDec";break;case"<":if(M&&(x.test(h)||a.test(h))){_.push({tag:"JSXTag"}),p+=1,h="<",yield{type:"JSXPunctuator",value:N};continue}S=!1;break;default:S=!1}p=W,h=T,yield{type:"Punctuator",value:N};continue}if(e.lastIndex=p,d=e.exec(E)){switch(p=e.lastIndex,T=d[0],d[0]){case"for":case"if":case"while":case"with":h!=="."&&h!=="?."&&(T="?NonExpressionParenKeyword")}h=T,S=!a.test(d[0]),yield{type:d[1]==="#"?"PrivateIdentifier":"IdentifierName",value:d[0]};continue}if(k.lastIndex=p,d=k.exec(E)){p=k.lastIndex,h=d[0],S=!0,yield{type:"StringLiteral",value:d[0],closed:d[2]!==void 0};continue}if(y.lastIndex=p,d=y.exec(E)){p=y.lastIndex,h=d[0],S=!0,yield{type:"NumericLiteral",value:d[0]};continue}if(l.lastIndex=p,d=l.exec(E)){p=l.lastIndex,h=d[0],d[1]==="${"?(h="?InterpolationInTemplate",_.push({tag:"InterpolationInTemplate",nesting:I.length}),S=!1,yield{type:"TemplateHead",value:d[0]}):(S=!0,yield{type:"NoSubstitutionTemplate",value:d[0],closed:d[1]==="`"});continue}break;case"JSXTag":case"JSXTagEnd":if(t.lastIndex=p,d=t.exec(E)){switch(p=t.lastIndex,T=d[0],d[0]){case"<":_.push({tag:"JSXTag"});break;case">":_.pop(),h==="/"||P.tag==="JSXTagEnd"?(T="?JSX",S=!0):_.push({tag:"JSXChildren"});break;case"{":_.push({tag:"InterpolationInJSX",nesting:I.length}),T="?InterpolationInJSX",S=!1;break;case"/":h==="<"&&(_.pop(),_[_.length-1].tag==="JSXChildren"&&_.pop(),_.push({tag:"JSXTagEnd"}))}h=T,yield{type:"JSXPunctuator",value:d[0]};continue}if(r.lastIndex=p,d=r.exec(E)){p=r.lastIndex,h=d[0],yield{type:"JSXIdentifier",value:d[0]};continue}if(n.lastIndex=p,d=n.exec(E)){p=n.lastIndex,h=d[0],yield{type:"JSXString",value:d[0],closed:d[2]!==void 0};continue}break;case"JSXChildren":if(i.lastIndex=p,d=i.exec(E)){p=i.lastIndex,h=d[0],yield{type:"JSXText",value:d[0]};continue}switch(E[p]){case"<":_.push({tag:"JSXTag"}),p++,h="<",yield{type:"JSXPunctuator",value:"<"};continue;case"{":_.push({tag:"InterpolationInJSX",nesting:I.length}),p++,h="?InterpolationInJSX",S=!1,yield{type:"JSXPunctuator",value:"{"};continue}}if(R.lastIndex=p,d=R.exec(E)){p=R.lastIndex,yield{type:"WhiteSpace",value:d[0]};continue}if(s.lastIndex=p,d=s.exec(E)){p=s.lastIndex,S=!1,o.test(h)&&(h="?NoLineTerminatorHere"),yield{type:"LineTerminatorSequence",value:d[0]};continue}if(u.lastIndex=p,d=u.exec(E)){p=u.lastIndex,f.test(d[0])&&(S=!1,o.test(h)&&(h="?NoLineTerminatorHere")),yield{type:"MultiLineComment",value:d[0],closed:d[1]!==void 0};continue}if(b.lastIndex=p,d=b.exec(E)){p=b.lastIndex,S=!1,yield{type:"SingleLineComment",value:d[0]};continue}$=String.fromCodePoint(E.codePointAt(p)),p+=$.length,h=$,S=!1,yield{type:P.tag.startsWith("JSX")?"JSXInvalid":"Invalid",value:$}}},D}Ye();var ce={keyword:["break","case","catch","continue","debugger","default","do","else","finally","for","function","if","return","switch","throw","try","var","const","while","with","new","this","super","class","extends","export","import","null","true","false","in","instanceof","typeof","void","delete"],strict:["implements","interface","let","package","private","protected","public","static","yield"]};new Set(ce.keyword),new Set(ce.strict);var ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ke=new Uint8Array(64),He=new Uint8Array(128);for(let e=0;e<ue.length;e++){let r=ue.charCodeAt(e);Ke[e]=r,He[r]=e}var de;(function(e){e[e.Empty=1]="Empty",e[e.Hash=2]="Hash",e[e.Query=3]="Query",e[e.RelativePath=4]="RelativePath",e[e.AbsolutePath=5]="AbsolutePath",e[e.SchemeRelative=6]="SchemeRelative",e[e.Absolute=7]="Absolute"})(de||(de={}));var Ze=/^[A-Za-z]:\//;function Ge(e=""){return e&&e.replace(/\\/g,"/").replace(Ze,r=>r.toUpperCase())}var Qe=/^[/\\](?![/\\])|^[/\\]{2}(?!\.)|^[A-Za-z]:[/\\]/;function et(){return typeof process<"u"&&typeof process.cwd=="function"?process.cwd().replace(/\\/g,"/"):"/"}var tt=function(...e){e=e.map(n=>Ge(n));let r="",t=!1;for(let n=e.length-1;n>=-1&&!t;n--){let i=n>=0?e[n]:et();!i||i.length===0||(r=`${i}/${r}`,t=fe(i))}return r=rt(r,!t),t&&!fe(r)?`/${r}`:r.length>0?r:"."};function rt(e,r){let t="",n=0,i=-1,a=0,o=null;for(let s=0;s<=e.length;++s){if(s<e.length)o=e[s];else{if(o==="/")break;o="/"}if(o==="/"){if(!(i===s-1||a===1))if(a===2){if(t.length<2||n!==2||t[t.length-1]!=="."||t[t.length-2]!=="."){if(t.length>2){let u=t.lastIndexOf("/");u===-1?(t="",n=0):(t=t.slice(0,u),n=t.length-1-t.lastIndexOf("/")),i=s,a=0;continue}else if(t.length>0){t="",n=0,i=s,a=0;continue}}r&&(t+=t.length>0?"/..":"..",n=2)}else t.length>0?t+=`/${e.slice(i+1,s)}`:t=e.slice(i+1,s),n=s-i-1;i=s,a=0}else o==="."&&a!==-1?++a:a=-1}return t}var fe=function(e){return Qe.test(e)},pe=/^\s*at .*(?:\S:\d+|\(native\))/m,nt=/^(?:eval@)?(?:\[native code\])?$/;function he(e){if(!e.includes(":"))return[e];let r=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/^\(|\)$/g,""));if(!r)return[e];let t=r[1];if(t.startsWith("async ")&&(t=t.slice(6)),t.startsWith("http:")||t.startsWith("https:")){let n=new URL(t);n.searchParams.delete("import"),n.searchParams.delete("browserv"),t=n.pathname+n.hash+n.search}if(t.startsWith("/@fs/")){let n=/^\/@fs\/[a-zA-Z]:\//.test(t);t=t.slice(n?5:4)}return[t,r[2]||void 0,r[3]||void 0]}function it(e){let r=e.trim();if(nt.test(r)||(r.includes(" > eval")&&(r=r.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),!r.includes("@")&&!r.includes(":")))return null;let t=/((.*".+"[^@]*)?[^@]*)(@)/,n=r.match(t),i=n&&n[1]?n[1]:void 0,[a,o,s]=he(r.replace(t,""));return!a||!o||!s?null:{file:a,method:i||"",line:Number.parseInt(o),column:Number.parseInt(s)}}function ot(e){let r=e.trim();return pe.test(r)?st(r):it(r)}function st(e){let r=e.trim();if(!pe.test(r))return null;r.includes("(eval ")&&(r=r.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));let t=r.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),n=t.match(/ (\(.+\)$)/);t=n?t.replace(n[0],""):t;let[i,a,o]=he(n?n[1]:t),s=n&&t||"",u=i&&["eval","<anonymous>"].includes(i)?void 0:i;return!u||!a||!o?null:(s.startsWith("async ")&&(s=s.slice(6)),u.startsWith("file://")&&(u=u.slice(7)),u=u.startsWith("node:")||u.startsWith("internal:")?u:tt(u),s&&(s=s.replace(/__vite_ssr_import_\d+__\./g,"")),{method:s,file:u,line:Number.parseInt(a),column:Number.parseInt(o)})}function at(e){let r=e?.globalThisKey||"__vitest_mocker__";function t(){return typeof globalThis[r]<"u"?globalThis[r]:new Proxy({},{get(n,i){throw new Error(`Vitest mocker was not initialized in this environment. vi.${String(i)}() is forbidden.`)}})}return{hoisted(n){if(typeof n!="function")throw new TypeError(`vi.hoisted() expects a function, but received a ${typeof n}`);return n()},mock(n,i){if(typeof n!="string")throw new TypeError(`vi.mock() expects a string path, but received a ${typeof n}`);let a=A("mock");t().queueMock(n,a,typeof i=="function"?()=>i(()=>t().importActual(n,a)):i)},unmock(n){if(typeof n!="string")throw new TypeError(`vi.unmock() expects a string path, but received a ${typeof n}`);t().queueUnmock(n,A("unmock"))},doMock(n,i){if(typeof n!="string")throw new TypeError(`vi.doMock() expects a string path, but received a ${typeof n}`);let a=A("doMock");t().queueMock(n,a,typeof i=="function"?()=>i(()=>t().importActual(n,a)):i)},doUnmock(n){if(typeof n!="string")throw new TypeError(`vi.doUnmock() expects a string path, but received a ${typeof n}`);t().queueUnmock(n,A("doUnmock"))},async importActual(n){return t().importActual(n,A("importActual"))},async importMock(n){return t().importMock(n,A("importMock"))}}}function A(e){let r=je({stackTraceLimit:5}).split(`
`),t=r.findIndex(i=>i.includes(` at Object.${e}`)||i.includes(`${e}@`));return ot(r[t+1])?.file||""}var ft=import.meta.hot||{on:z,off:z,send:z};function z(){console.warn("Vitest mocker cannot work if Vite didn't establish WS connection.")}var{now:ye}=Date,lt=class{registry=new j;queue=new Set;mockedIds=new Set;constructor(e,r,t,n){this.interceptor=e,this.rpc=r,this.spyOn=t,this.config=n}async prepare(){this.queue.size&&await Promise.all([...this.queue.values()])}async resolveFactoryModule(e){let r=this.registry.get(e);if(!r||r.type!=="manual")throw new Error(`Mock ${e} wasn't registered. This is probably a Vitest error. Please, open a new issue with reproduction.`);return await r.resolve()}getFactoryModule(e){let r=this.registry.get(e);if(!r||r.type!=="manual")throw new Error(`Mock ${e} wasn't registered. This is probably a Vitest error. Please, open a new issue with reproduction.`);if(!r.cache)throw new Error(`Mock ${e} wasn't resolved. This is probably a Vitest error. Please, open a new issue with reproduction.`);return r.cache}async invalidate(){let e=Array.from(this.mockedIds);e.length&&(await this.rpc.invalidate(e),await this.interceptor.invalidate(),this.registry.clear())}async importActual(e,r){let t=await this.rpc.resolveId(e,r);if(t==null)throw new Error(`[vitest] Cannot resolve "${e}" imported from "${r}"`);let n=Ae(t.id),i=new URL(t.url,location.href),a=`_vitest_original&ext${n}`,o=`${i.pathname}${i.search?`${i.search}&${a}`:`?${a}`}${i.hash}`;return this.wrapDynamicImport(()=>import(o)).then(s=>{if(!t.optimized||typeof s.default>"u")return s;let u=s.default;return u?.__esModule?u:{...typeof u=="object"&&!Array.isArray(u)||typeof u=="function"?u:{},default:u}})}async importMock(e,r){await this.prepare();let{resolvedId:t,resolvedUrl:n,redirectUrl:i}=await this.rpc.resolveMock(e,r,{mock:"auto"}),a=this.resolveMockPath(L(n)),o=this.registry.get(a);if(!o)if(i){let s=new URL(this.resolveMockPath(L(i)),location.href).toString();o=new q(e,t,a,s)}else o=new B(e,t,a);if(o.type==="manual")return await o.resolve();if(o.type==="automock"||o.type==="autospy"){let s=new URL(`/@id/${t}`,location.href),u=s.search?`${s.search}&t=${ye()}`:`?t=${ye()}`,f=await import(`${s.pathname}${u}&mock=${o.type}${s.hash}`);return this.mockObject(f,o.type)}return import(o.redirect)}mockObject(e,r="automock"){return ve({globalConstructors:{Object,Function,Array,Map,RegExp},spyOn:this.spyOn,type:r},e)}queueMock(e,r,t){let n=this.rpc.resolveMock(e,r,{mock:typeof t=="function"?"factory":t?.spy?"spy":"auto"}).then(async({redirectUrl:i,resolvedId:a,resolvedUrl:o,needsInterop:s,mockType:u})=>{let f=this.resolveMockPath(L(o));this.mockedIds.add(a);let y=typeof t=="function"?async()=>{let b=await t();return s?{default:b}:b}:void 0,g=typeof i=="string"?new URL(this.resolveMockPath(L(i)),location.href).toString():null,m;u==="manual"?m=this.registry.register("manual",e,a,f,y):u==="autospy"?m=this.registry.register("autospy",e,a,f):u==="redirect"?m=this.registry.register("redirect",e,a,f,g):m=this.registry.register("automock",e,a,f),await this.interceptor.register(m)}).finally(()=>{this.queue.delete(n)});this.queue.add(n)}queueUnmock(e,r){let t=this.rpc.resolveId(e,r).then(async n=>{if(!n)return;let i=this.resolveMockPath(L(n.url));this.mockedIds.add(n.id),this.registry.delete(i),await this.interceptor.delete(i)}).finally(()=>{this.queue.delete(t)});this.queue.add(t)}wrapDynamicImport(e){return typeof e=="function"?new Promise((r,t)=>{this.prepare().finally(()=>{e().then(r,t)})}):e}resolveMockPath(e){let r=this.config,t=Re("/@fs/",r.root);return e.startsWith(r.root)?e.slice(r.root.length):e.startsWith(t)?e.slice(t.length):e}},ct=/(\?|&)v=\w{8}/;function L(e){return e.replace(ct,"")}var me=class{mocks=new j;constructor(){}async register(e){this.mocks.add(e)}async delete(e){this.mocks.delete(e)}async invalidate(){this.mocks.clear()}},V=e=>{switch(e){case"resolveId":return Promise.resolve({id:"",url:"",optimized:!1});case"resolveMock":return Promise.resolve({mockType:"dummy",resolvedId:"",resolvedUrl:"",redirectUrl:"",needsInterop:!1});case"invalidate":return Promise.resolve()}},ut=class extends lt{queueMock(){}};function dt(e){let r=new ut(e("__vitest_mocker__"),{resolveId(t,n){return V("resolveId",{id:t,importer:n})},resolveMock(t,n,i){return V("resolveMock",{id:t,importer:n,options:i})},async invalidate(t){return V("invalidate",{ids:t})}},(...t)=>globalThis.__STORYBOOK_MODULE_TEST__.spyOn(...t),{root:""});return globalThis.__vitest_mocker__=r,at({globalThisKey:"__vitest_mocker__"})}globalThis.__STORYBOOK_MOCKER__=dt(()=>new me);export{me as ModuleMockerInterceptor};
